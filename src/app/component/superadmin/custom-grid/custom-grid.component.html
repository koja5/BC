<div style="height: 100%" *ngIf="language !== undefined">
    <kendo-grid [data]="gridView" [style.height]="height" [resizable]="true" [pageSize]="state.take" [skip]="state.skip" [sort]="state.sort" [filter]="state.filter" [sortable]="true" [pageable]="pageable" (pageChange)="pageChange($event)" [kendoGridSelectBy]="mySelectionKey"
        [groupable]="true" [group]="state.group" [pageSize]="pageSize" (groupChange)="groupChange($event)" (sortChange)="sortChange($event)">
        <kendo-grid-messages pagerPage="{{language.pagerPage}}" pagerOf="{{language.pagerOf}}" pagerItems="{{language.pagerItems}}" pagerItemsPerPage="{{language.pagerItemsPerPage}}">
        </kendo-grid-messages>
        <ng-template kendoGridToolbarTemplate>
            <div class="search">
                <kendo-textbox-container floatingLabel="{{language.searchAllColumn}}">
                    <input kendoTextBox (input)="onFilter($event.target.value)" [(ngModel)]="searchFilter" />
                </kendo-textbox-container>
            </div>
            <div class="search-combobox" *ngIf="gridConfiguration.search !== undefined">
                <kendo-textbox-container floatingLabel="{{language.searchAllColumn}}">
                    <kendo-combobox [data]="typeOfUsers" [valuePrimitive]="true" [textField]="'type'" [valueField]="'id'" (selectionChange)="filterUserType($event)" class="col-xs-12 noPadding" [(ngModel)]="selectedUserTypeFilter" name="search">
                    </kendo-combobox>
                </kendo-textbox-container>
            </div>
            <div style="float: right; padding-right: 30px; padding-top: 14px;">
                <button *ngIf="gridConfiguration.new.open === 'modal'" kendoButton [icon]="'add'" (click)="openModal(gridConfiguration.type)" [primary]="true" class="addButton">{{language.createData}}</button>
                <button *ngIf="gridConfiguration.new.open === 'page'" kendoButton [icon]="'add'" [routerLink]="gridConfiguration.new.link" [primary]="true" class="addButton">{{language.createData}}</button>
                <div class="dropdown-grid">
                    <button class="btn-grid" style="border-left:1px solid #0d8bf2">
                        <i class="fa fa-caret-down"></i>
                    </button>
                    <div class="dropdown-content-grid">
                        <a style="padding: 0px; text-transform: uppercase;"><label class="uploadFromExcel-{{theme}}"
                                style="padding: 12px; cursor: pointer;"><span class='k-icon k-i-file-excel'></span>
                                {{ language.uploadFromExcel }}<input type="file" name="files[]" multiple id="jsonFile"
                                    accept=".xlsx" (change)="onFileChange($event)"
                                    [(ngModel)]="fileValue" /></label></a>
                        <a kendoGridPDFCommand><span class="k-icon k-i-file-pdf"></span> {{language.exportToPDF}}</a>
                        <a kendoGridExcelCommand><span class="k-icon k-i-file-excel"></span>
                            {{language.exportToExcel}}</a>
                    </div>
                </div>
            </div>
        </ng-template>

        <kendo-grid-column *ngFor="let item of gridConfiguration.columns; let i = index" [field]="item.field" title="{{language[item.title]}}" [width]="item.width" [hidden]="item.hidden">
            <ng-template *ngIf="item.type === 'button'" kendoGridCellTemplate let-dataItem let-rowIndex="rowIndex">
                <div *ngIf="item.action === 'preview'">
                    <button *ngIf="item.open === 'modal'" kendoButton [icon]="item.icon" class='{{item.class}}' (click)="previewUser(dataItem)"></button>
                    <button *ngIf="item.open === 'page'" kendoButton [icon]="item.icon" class='{{item.class}}' (click)="generateLink(item.link, dataItem[item.param])"></button>
                </div>

                <div *ngIf="item.action === 'edit-member'">
                    <button kendoButton [icon]="item.icon" class='{{item.class}}' (click)="editMember(dataItem)"></button>
                </div>
                <div *ngIf="item.action === 'edit-event'">
                    <button kendoButton [icon]="item.icon" class='{{item.class}}' (click)="editEvent(dataItem)"></button>
                </div>

                <div *ngIf="item.action === 'delete'">
                    <button kendoButton [icon]="item.icon" (click)="openDialogDelete(dataItem[item.param], item.method, rowIndex)"></button>
                </div>
            </ng-template>
            <ng-template *ngIf="item.type === 'boolean'" kendoGridCellTemplate let-dataItem let-rowIndex="rowIndex">
                <div *ngIf="item.action === 'active'">
                    <span *ngIf="dataItem[item.field]" class="label label-success ng-star-inserted">Active</span>
                    <span *ngIf="!dataItem[item.field]" class="label label-danger ng-star-inserted">Inactive</span>
                </div>
            </ng-template>
            <ng-template *ngIf="item.type === 'image'" kendoGridCellTemplate let-dataItem let-rowIndex="rowIndex">
                <img src="{{item.rootPath}}{{dataItem[item.field]}}" class="column-image">
            </ng-template>
            <ng-template *ngIf="item.type === 'datetime'" kendoGridCellTemplate let-dataItem let-rowIndex="rowIndex">
                <div>
                    {{ dataItem[item.field] | date: item.format }}
                </div>
            </ng-template>
        </kendo-grid-column>

        <kendo-grid-pdf fileName="data.pdf" [allPages]="true">
            <kendo-grid-pdf-margin top="1cm" left="1cm" right="1cm" bottom="1cm"></kendo-grid-pdf-margin>
        </kendo-grid-pdf>
        <!-- <kendo-grid-excel fileName="Customers.xlsx"></kendo-grid-excel> -->
        <kendo-grid-excel fileName="data.xlsx" [fetchData]="allData"></kendo-grid-excel>
        <ng-template kendoGridNoRecordsTemplate>
            <div class="row no-results-element">
                <div class="text-center">
                    <i class="fa fa-heartbeat no-results-icon"></i><br>
                </div>
                <div class="text-center m-t-md">
                    <p class="m-b-none">
                        {{language.noRecords}} </p>
                </div>
            </div>
        </ng-template>
    </kendo-grid>

</div>